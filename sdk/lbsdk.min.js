"use strict";var QWebChannelMessageTypes={signal:1,propertyUpdate:2,init:3,idle:4,debug:5,invokeMethod:6,connectToSignal:7,disconnectFromSignal:8,setProperty:9,response:10};var QWebChannel=function(e,o){if(typeof e!=="object"||typeof e.send!=="function"){console.error("The QWebChannel expects a transport object with a send function and onmessage callback property."+" Given is: transport: "+typeof e+", transport.send: "+typeof e.send);return}var i=this;this.transport=e;this.send=function(e){if(typeof e!=="string"){e=JSON.stringify(e)}i.transport.send(e)};this.transport.onmessage=function(e){var n=e.data;if(typeof n==="string"){n=JSON.parse(n)}switch(n.type){case QWebChannelMessageTypes.signal:i.handleSignal(n);break;case QWebChannelMessageTypes.response:i.handleResponse(n);break;case QWebChannelMessageTypes.propertyUpdate:i.handlePropertyUpdate(n);break;default:console.error("invalid message received:",e.data);break}};this.execCallbacks={};this.execId=0;this.exec=function(e,n){if(!n){i.send(e);return}if(i.execId===Number.MAX_VALUE){i.execId=Number.MIN_VALUE}if(e.hasOwnProperty("id")){console.error("Cannot exec message with property id: "+JSON.stringify(e));return}e.id=i.execId++;i.execCallbacks[e.id]=n;i.send(e)};this.objects={};this.handleSignal=function(e){var n=i.objects[e.object];if(n){n.signalEmitted(e.signal,e.args)}else{console.warn("Unhandled signal: "+e.object+"::"+e.signal)}};this.handleResponse=function(e){if(!e.hasOwnProperty("id")){console.error("Invalid response message received: ",JSON.stringify(e));return}i.execCallbacks[e.id](e.data);delete i.execCallbacks[e.id]};this.handlePropertyUpdate=function(e){for(var n in e.data){var t=e.data[n];var o=i.objects[t.object];if(o){o.propertyUpdate(t.signals,t.properties)}else{console.warn("Unhandled property update: "+t.object+"::"+t.signal)}}i.exec({type:QWebChannelMessageTypes.idle})};this.debug=function(e){i.send({type:QWebChannelMessageTypes.debug,data:e})};i.exec({type:QWebChannelMessageTypes.init},function(e){for(var n in e){var t=new QObject(n,e[n],i)}for(var n in i.objects){i.objects[n].unwrapProperties()}if(o){o(i)}i.exec({type:QWebChannelMessageTypes.idle})})};function QObject(e,n,r){this.__id__=e;r.objects[e]=this;this.__objectSignals__={};this.__propertyCache__={};var c=this;this.unwrapQObject=function(e){if(e instanceof Array){var n=new Array(e.length);for(var t=0;t<e.length;++t){n[t]=c.unwrapQObject(e[t])}return n}if(!e||!e["__QObject*__"]||e.id===undefined){return e}var o=e.id;if(r.objects[o])return r.objects[o];if(!e.data){console.error("Cannot unwrap unknown QObject "+o+" without data.");return}var i=new QObject(o,e.data,r);i.destroyed.connect(function(){if(r.objects[o]===i){delete r.objects[o];var e=[];for(var n in i){e.push(n)}for(var t in e){delete i[e[t]]}}});i.unwrapProperties();return i};this.unwrapProperties=function(){for(var e in c.__propertyCache__){c.__propertyCache__[e]=c.unwrapQObject(c.__propertyCache__[e])}};function i(e,t){var o=e[0];var i=e[1];c[o]={connect:function(e){if(typeof e!=="function"){console.error("Bad callback given to connect to signal "+o);return}c.__objectSignals__[i]=c.__objectSignals__[i]||[];c.__objectSignals__[i].push(e);if(!t&&o!=="destroyed"){r.exec({type:QWebChannelMessageTypes.connectToSignal,object:c.__id__,signal:i})}},disconnect:function(e){if(typeof e!=="function"){console.error("Bad callback given to disconnect from signal "+o);return}c.__objectSignals__[i]=c.__objectSignals__[i]||[];var n=c.__objectSignals__[i].indexOf(e);if(n===-1){console.error("Cannot find connection of signal "+o+" to "+e.name);return}c.__objectSignals__[i].splice(n,1);if(!t&&c.__objectSignals__[i].length===0){r.exec({type:QWebChannelMessageTypes.disconnectFromSignal,object:c.__id__,signal:i})}}}}function a(e,n){var t=c.__objectSignals__[e];if(t){t.forEach(function(e){e.apply(e,n)})}}this.propertyUpdate=function(e,n){for(var t in n){var o=n[t];c.__propertyCache__[t]=o}for(var i in e){a(i,e[i])}};this.signalEmitted=function(e,n){a(e,this.unwrapQObject(n))};function t(e){var n=e[0];var i=e[1];c[n]=function(){var e=[];var t;for(var n=0;n<arguments.length;++n){var o=arguments[n];if(typeof o==="function")t=o;else if(o instanceof QObject&&r.objects[o.__id__]!==undefined)e.push({id:o.__id__});else e.push(o)}r.exec({type:QWebChannelMessageTypes.invokeMethod,object:c.__id__,method:i,args:e},function(e){if(e!==undefined){var n=c.unwrapQObject(e);if(t){t(n)}}})}}function o(e){var t=e[0];var o=e[1];var n=e[2];c.__propertyCache__[t]=e[3];if(n){if(n[0]===1){n[0]=o+"Changed"}i(n,true)}Object.defineProperty(c,o,{configurable:true,get:function(){var e=c.__propertyCache__[t];if(e===undefined){console.warn('Undefined value in property cache for property "'+o+'" in object '+c.__id__)}return e},set:function(e){if(e===undefined){console.warn("Property setter for "+o+" called with undefined value!");return}c.__propertyCache__[t]=e;var n=e;if(n instanceof QObject&&r.objects[n.__id__]!==undefined)n={id:n.__id__};r.exec({type:QWebChannelMessageTypes.setProperty,object:c.__id__,property:t,value:n})}})}n.methods.forEach(t);n.properties.forEach(o);n.signals.forEach(function(e){i(e,false)});for(var e in n.enums){c[e]=n.enums[e]}}if(typeof module==="object"){module.exports={QWebChannel:QWebChannel}}var contextObj;var configObj;var tokenObj;var pinObj;var projectInfoObj;var docUDLoadObj;var elementObj;var floorObj;var attributeObj;var constructionSectionObj;var operateObj;var viewObj;var sdkChannel=new QWebChannel(qt.webChannelTransport,function(e){contextObj=e.objects.contextObj;configObj=e.objects.configObj;tokenObj=e.objects.tokenObj;pinObj=e.objects.pinObj;projectInfoObj=e.objects.projectInfoObj;docUDLoadObj=e.objects.docUDLoadObj;elementObj=e.objects.elementObj;floorObj=e.objects.floorObj;attributeObj=e.objects.attributeObj;constructionSectionObj=e.objects.constructionSectionObj;operateObj=e.objects.operateObj;viewObj=e.objects.viewObj});var EEventType={DOCUMENTOPENING:0,DOCUMENTOPENED:1,DOCUMENTCLOSING:2,DOCUMENTCLOSED:3,PINLMOUSEBUTTONPRESS:4,PINLMOUSEBUTTONDBLCLICK:5,DOCUPLOAD:6,DOCDOWNLOAD:7,TOKENAPPLY:8,REQ_OPENDOCUMENT:9,REQ_CLOSEOCUMENT:10,WEBVIEWCLOSED:11};var setRecvdMsgCallBack=function(n){var e=1;contextObj.VerifySDKVersion(e,function(e){if(e===false){alert("平台当前版本过低，插件可能无法正常工作，请升级到最新版本！")}contextObj.recvdMsg.connect(n)})};var initRecvdMsgCallback=function(e,n){try{if(typeof contextObj!=="undefined"){if(typeof setRecvdMsgCallBack!=="undefined"){setRecvdMsgCallBack(e);if(typeof n==="function")n(true)}else{setTimeout(function(){initRecvdMsgCallback(e,n)},500)}}else{setTimeout(function(){initRecvdMsgCallback(e,n)},500)}}catch(e){alert(e);if(typeof n==="function")n(false)}};var removeRecvdMsgCallBack=function(e){contextObj.recvdMsg.disconnect(e)};var ESystemMode={DebugMode:0,ReleaseMode:1};var setSystemMode=function(e){return configObj.SetSystemMode(e)};var getAllAttribute=function(n){return attributeObj.GetAllAttribute(function(e){if(typeof n==="function")n(e)})};var getAttributeInfo=function(e,n){return attributeObj.GetAttributeInfo(e,function(e){if(typeof n==="function")n(e)})};var getAllAttributeInfo=function(n){return attributeObj.GetAllAttributeInfo(function(e){if(typeof n==="function")n(e)})};var getAllConstructionSection=function(n){return constructionSectionApi.GetAllConstructionSection(function(e){if(typeof n==="function")n(e)})};var getConstructionSectionInfo=function(e,n){return constructionSectionApi.GetConstructionSectionInfo(e,function(e){if(typeof n==="function")n(e)})};var getAllConstructionSectionInfo=function(n){return constructionSectionApi.GetAllConstructionSectionInfo(function(e){if(typeof n==="function")n(e)})};var EDocUDLoadType={PROJ:0,DOC:1};var uploadFile=function(e,n){return docUDLoadObj.UploadFile(JSON.stringify(e),function(e){if(typeof n==="function")n(e)})};var getAllElement=function(n){return elementApi.GetAllElement(function(e){if(typeof n==="function")n(e)})};var getAttributeInfo=function(e,n){return elementApi.GetAttributeInfo(e,function(e){if(typeof n==="function")n(e)})};var getAllElementInfo=function(n){return elementApi.GetAllElementInfo(function(e){if(typeof n==="function")n(e)})};var getAllFloor=function(n){return floorObj.GetAllFloor(function(e){if(typeof n==="function")n(e)})};var getFloorAttribute=function(e,n){return floorObj.GetFloorAttribute(e,function(e){if(typeof n==="function")n(e)})};var captureViewPoint=function(n){return operateObj.CaptureViewPoint(function(e){if(typeof n==="function")n(e)})};var setPinImagePath=function(e){return pinObj.SetImagePath(e)};var getPinInfo=function(e,n,t){return pinObj.GetItemInfo(e,n,function(e){if(typeof t==="function")t(e)})};var getAllPinInfo=function(n){return pinObj.GetAllItemInfo(function(e){if(typeof n==="function")n(e)})};var addPin=function(e,n){return pinObj.AddItem(e,function(e){if(typeof n==="function")n(e)})};var delPin=function(e,n,t){return pinObj.DelItem(e,n,function(e){if(typeof t==="function")t(e)})};var setPinHighLight=function(e,n,t,o){return pinObj.HighLight(e,n,t,function(e){if(typeof o==="function")o(e)})};var setPinVisible=function(e,n,t,o){return pinObj.SetVisible(e,n,t,function(e){if(typeof o==="function")o(e)})};var EProjectType={PROJ_TYPE_NULL:0,PROJ_TYPE_TJ:1,PROJ_TYPE_GJ:2,PROJ_TYPE_AZ:3,PROJ_TYPE_REVIT:4,PROJ_TYPE_ZJ:5,PROJ_TYPE_TEKLA:6,PROJ_TYPE_CIVIL3D:7,PROJ_TYPE_BENTLEY:8,PROJ_TYPE_RHINO:9,PROJ_TYPE_IFC:10,PROJ_TYPE_REMIZ:11,PROJ_TYPE_SITE:12};var EProjectModelType={PROJ_MODEL_NULL:0,PROJ_MODEL_SLYS:1,PROJ_MODEL_SLSG:2};var getProjectInfo=function(n){return projectInfoObj.GetProjectInfo(function(e){if(typeof n==="function")n(e)})};var getPID=function(n){return projectInfoObj.GetPID(function(e){if(typeof n==="function")n(e)})};var getDeptID=function(n){return projectInfoObj.GetDeptID(function(e){if(typeof n==="function")n(e)})};var getProjectType=function(n){return projectInfoObj.GetProjectType(function(e){if(typeof n==="function")n(e)})};var getProjectName=function(n){return projectInfoObj.GetProjectName(function(e){if(typeof n==="function")n(e)})};var getProjectModelType=function(n){return projectInfoObj.GetProjectModelType(function(e){if(typeof n==="function")n(e)})};var initToken1=function(e,n){return tokenObj.InitToken1(e,function(e){if(typeof n==="function")n(e)})};var initToken2=function(e,n,t){return tokenObj.InitToken2(e,n,function(e){if(typeof t==="function")t(e)})};var createWebView=function(n,t){return viewObj.CreateWebView(JSON.stringify(n),function(e){if(typeof t==="function")t(n.dialogId,e)})};var showWebView=function(n,e,t){return viewObj.ShowWebView(n,e,function(e){if(typeof t==="function")t(n,e)})};var closeWebView=function(n,t){return viewObj.CloseWebView(n,function(e){if(typeof t==="function")t(n,e)})};